<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="productMapper">

<!-- 상품 정보 -->
<select id="selectProd" resultType="productDTO">
	SELECT 	PROD_SUBCODE, PROD_PRICE, PROD_CONTENTS, PROD_STYLE, PROD_GENDER 
	FROM 	PRODUCT_INFO
</select>

<!-- 상품 이미지 정보 -->
<!-- 이미지가 한 폴더가 아닌 카테고리별로 분류될 경우를 대비하여 join문 사용 -->
<!-- List<String> 으로 처리해보고 이상있을시 DTO 이용 -->
<select id="selectProdImg" resultType="String">
	SELECT 	A.PROD_IMG
	FROM 	PRODUCT_IMG A, product_info B
	WHERE 	A.PROD_SUBCODE = B.PROD_SUBCODE
</select>

<!-- 상품 별점/리뷰수 -->
<!-- HashMap<String, Object> 로 처리해보고 이상있을시 DTO 이용 -->
<select id="selectProdScore" resultType="hashMap">
	SELECT 	COUNT(*) AS CNT, ROUND(AVG(REVIEW_SCORE), 1) AS AVG 
	FROM 	REVIEW
</select>

<!-- 상품 찜 여부 -->
<select id="selectProdHeart" resultType="String">
	SELECT PROD_CODE FROM HEART
</select>

<!-- 상품 장바구니 여부 -->
<select id="selectProdCart" resultType="String">
	SELECT PROD_CODE FROM CART
</select>

<!-- 상품 사이즈/컬러 데이터 -->
<!-- List<String> 으로 처리해보고 이상있을시 Product 데이터 부분이라 필요하면 DTO 에 입력 후 이용 -->
<select id="selectProdChoice" resultType="String">
	SELECT 	CASE '매개변수' WHEN 'C' THEN PROD_COLOR WHEN 'S' THEN PROD_SIZE END AS CHOICE 
	FROM 	PRODUCT
	GROUP BY CASE '매개변수' WHEN 'C' THEN PROD_COLOR WHEN 'S' THEN PROD_SIZE END
	ORDER BY CHOICE
</select>

</mapper>